<div class="container mt-4">
  <h1 class="text-center">Tracks</h1>
  <table id="tracks-table" class="table table-striped table-hover" data-controller="sort">
    <thead class="thead-dark">
    <tr>
      <th data-action="click->sort#sort" data-sort-column="name" class="sortable">Name <%= sort_icon('name') %></th>
      <th>Artist(s)</th>
      <th data-action="click->sort#sort" data-sort-column="keys.name" class="sortable">Key <%= sort_icon('keys.name') %></th>
      <th data-action="click->sort#sort" data-sort-column="bpm" class="sortable">BPM <%= sort_icon('bpm') %></th>
      <th data-action="click->sort#sort" data-sort-column="time" class="sortable">Time <%= sort_icon('time') %></th>
      <th data-action="click->sort#sort" data-sort-column="album" class="sortable">Album <%= sort_icon('album') %></th>
      <th>Date Added</th>
      <th>Playlists</th>
    </tr>
    </thead>
    <tbody>
    <% @tracks.each do |track| %>
      <tr>
        <td><%= track.name %></td>
        <td>
          <% track.artists.each do |artist| %>
            <%= link_to artist.name, artist_path(artist), class: 'text-decoration-none text-dark' %>
            <%= ',' unless artist == track.artists.last %>
          <% end %>
        </td>
        <td><%= link_to track.key&.name, key_path(track.key), class: 'text-decoration-none text-dark' if track.key %></td>
        <td><%= track.bpm %></td>
        <td><%= format_time(track.time) %></td>
        <td><%= track.album %></td>
        <td><%= track.date_added %></td>
        <td>
          <% track.playlists.each do |playlist| %>
            <%= link_to playlist.name, playlist_path(playlist), class: 'text-decoration-none text-dark' %>
            <%= ',' unless playlist == track.playlists.last %>
          <% end %>
        </td>
      </tr>
    <% end %>
    </tbody>
  </table>
</div>
